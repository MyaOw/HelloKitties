<h1> Your Cart: </h1>

<div class="container">
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Unit Price</th>
                <th>Quantity</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            <% @cart.items.each do |item| %>
                <tr>
                    <th><%= item.title %></th>
                    <th><%= item.price %> €</th>
                    <th><%= item.cart_items.find_by(cart_id: @cart.id).quantity %></th>
                    <th><%= item.price * item.cart_items.find_by(cart_id: @cart.id).quantity %> €</th>        
                </tr>
            <% end %>
            <tr>
                <th> Total Price:</th>
                <th></th>
                <th></th>
                <th><%= @cart.total %> €</th>
            </tr>
        </tbody>
    </table>
</div>

  <%= form_tag charges_path do %>
  <script src='https://checkout.stripe.com/checkout.js' class='stripe-button'
                    data-key='<%= Rails.configuration.stripe[:publishable_key] %>'
                    data-description='Payez votre commande'
                    data-email="<%= current_user.email %>"
                    data-currency= 'eur',
                    data-amount="<%= (current_user.cart.total) * 100 %>"
                    data-locale='auto'></script>
  <% end %>
